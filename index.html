<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Register for Appointment</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="style.css" rel="stylesheet"> </head>

<body class="container-fluid container-md">
    <div id="loadingOverlay">
      <div class="text-center">
        <div class="spinner-border text-primary" role="status">
          <span class="visually-hidden">Loading...</span>
        </div>
        <div class="mt-2">Please waitâ€¦</div>
      </div>
    </div>

    <header class="container mb-5">
        <div class="row align-items-center">
            <div class="col-auto">
                <img src="https://prism.org/Lab_Assets/phl-logo-color.png" alt="Prism Health Lab Logo" class="img-fluid" style="max-height:60px;">
            </div>
            <div class="col text-center">
                <h1 class="mb-0">Vaccine Event Registration</h1>
            </div>
        </div>
    </header>

    <div>
        <h2 class="d-flex justify-content-between align-items-center">
            <span id="eventDetails"></span>
        </h2>
    </div>

    <div id="slotSection">
        <h3 class="d-flex justify-content-between align-items-center">
            <span>Select an Appointment Slot</span>
        </h3>
        <div id="slotsGrid">
            </div>
    </div>

    <div id="formSection" class="d-none">
        <h3 class="d-flex justify-content-between align-items-center">
            <button class="btn btn-outline-secondary" type="button" id="goBackButton">Back</button>
            <span id="timer"></span>
        </h3>
        <h3 class="text-center">
            <span>Complete Your Registration</span>
        </h3>
          <form id="regForm">
          <!-- Demographics -->
          <div class="mb-4">
            <h4>Demographics</h4>
            <div class="row g-3">
              <div class="col-md-4">
                <label for="firstName" class="form-label">First Name *</label>
                <input type="text" class="form-control" id="firstName" name="firstName" required>
              </div>
              <div class="col-md-4">
                <label for="middleName" class="form-label">Middle Name</label>
                <input type="text" class="form-control" id="middleName" name="middleName">
              </div>
              <div class="col-md-4">
                <label for="lastName" class="form-label">Last Name *</label>
                <input type="text" class="form-control" id="lastName" name="lastName" required>
              </div>
              <div class="col-md-4">
                <label for="dob" class="form-label">Date of Birth *</label>
                <input type="date" class="form-control" id="dob" name="dob" required>
              </div>
              <div class="col-md-4">
                <label for="gender" class="form-label">Gender *</label>
                <select class="form-select" id="gender" name="gender" required>
                  <option value="" disabled selected></option>
                  <option>Male</option>
                  <option>Female</option>
                  <option>Other</option>
                  <option>Decline to Answer</option>
                </select>
              </div>
              <div class="col-md-4">
                <label for="race" class="form-label">Race *</label>
                <select class="form-select" id="race" name="race" required>
                  <option value="" disabled selected></option>
                  <option>American Indian or Alaska Native</option>
                  <option>Asian</option>
                  <option>White or Caucasian</option>
                  <option>Black or African American</option>
                  <option>Middle Eastern or North African</option>
                  <option>Native Hawaiian or Pacific Islander</option>
                  <option>Prefer not to answer</option>
                  <option>Unknown</option>
                </select>
              </div>
              <div class="col-md-4">
                <label for="ethnicity" class="form-label">Ethnicity *</label>
                <select class="form-select" id="ethnicity" name="ethnicity" required>
                  <option value="" disabled selected></option>
                  <option>Hispanic or Latino</option>
                  <option>Not Hispanic or Latino</option>
                  <option>Prefer not to answer</option>
                </select>
              </div>
              <div id="parentFields" class="col-12 d-none">
                <label class="form-label">Parent/Guardian Information</label>
                <div class="row g-3">
                  <div class="col-md-4">
                    <input type="text" class="form-control" id="parentName" name="parentName" placeholder="Name">
                  </div>
                  <div class="col-md-4">
                    <input type="text" class="form-control" id="parentRel" name="parentRel" placeholder="Relationship">
                  </div>
                  <div class="col-md-4">
                    <input type="tel" class="form-control" id="parentContact" name="parentContact" pattern="^(?:\(\d{3}\)\s*|\d{3}[.\-]?)\d{3}[.\-]?\d{4}$" placeholder="(XXX) XXX-XXXX">
                  </div>
                </div>
              </div>
              <div class="col-md-6">
                <label for="street" class="form-label">Street Address</label>
                <input type="text" class="form-control" id="street" name="street">
              </div>
              <div class="col-md-4">
                <label for="city" class="form-label">City</label>
                <input type="text" class="form-control" id="city" name="city">
              </div>
              <div class="col-md-4">
                <label for="state" class="form-label">State</label>
                <input type="text" class="form-control" id="state" name="state">
              </div>
              <div class="col-md-4">
                <label for="zip" class="form-label">Zip Code *</label>
                <input type="text" class="form-control" id="zip" name="zip"
                       placeholder="12345" pattern="\d{5}" maxlength="5"
                       inputmode="numeric" required>
              </div>
              <div class="col-md-6">
                <label for="cell" class="form-label">Cell Phone *</label>
                <input type="tel" class="form-control" id="cell" name="cell"
                       placeholder="(XXX) XXX-XXXX"
                       pattern="^(?:\(\d{3}\)\s*|\d{3}[.\-]?)\d{3}[.\-]?\d{4}$" required>
              </div>
              <div class="col-md-6">
                <label for="home" class="form-label">Home Phone</label>
                <input type="tel" class="form-control" id="home" name="home"
                       placeholder="(XXX) XXX-XXXX"
                       pattern="^(?:\(\d{3}\)\s*|\d{3}[.\-]?)\d{3}[.\-]?\d{4}$">
              </div>
              <div class="col-md-6">
                <label for="email" class="form-label">Email Address *</label>
                <input type="email" class="form-control" id="email" name="email"
                       placeholder="user@example.com"
                       pattern="^[A-Za-z0-9._%+\-]+@[A-Za-z0-9.\-]+\.[A-Za-z]{2,}$"
                       required>
              </div>
              <div class="col-md-6">
                <label for="ssn" class="form-label">Social Security #</label>
                <input type="text" class="form-control" id="ssn" name="ssn">
              </div>
            </div>
          </div>
  
          <!-- Insurance -->
          <div class="mb-4">
            <h4>Insurance</h4>
            <div class="row g-3">
              <div class="col-md-6">
                <label for="primaryIns" class="form-label">Primary Insurance</label>
                <input type="text" class="form-control" id="primaryIns" name="primaryIns">
              </div>
              <div class="col-md-6">
                <label for="primaryPayer" class="form-label">Primary Insurance Payer Name</label>
                <input type="text" class="form-control" id="primaryPayer" name="primaryPayer">
              </div>
              <div class="col-md-6">
                <label for="primaryPlan" class="form-label">Primary Insurance Plan Name</label>
                <input type="text" class="form-control" id="primaryPlan" name="primaryPlan">
              </div>
              <div class="col-md-3">
                <label for="primaryId" class="form-label">Primary Insurance ID</label>
                <input type="text" class="form-control" id="primaryId" name="primaryId">
              </div>
              <div class="col-md-3">
                <label for="primaryGroup" class="form-label">Group #</label>
                <input type="text" class="form-control" id="primaryGroup" name="primaryGroup">
              </div>
              <div class="col-md-6">
                <label for="primaryPayerId" class="form-label">Primary Insurance Payer ID</label>
                <input type="text" class="form-control" id="primaryPayerId" name="primaryPayerId">
              </div>
              <div class="col-md-6">
                <label for="secondaryIns" class="form-label">Secondary Insurance</label>
                <input type="text" class="form-control" id="secondaryIns" name="secondaryIns">
              </div>
              <div class="col-md-6">
                <label for="secondaryPlan" class="form-label">Secondary Insurance Plan Name</label>
                <input type="text" class="form-control" id="secondaryPlan" name="secondaryPlan">
              </div>
              <div class="col-md-3">
                <label for="secondaryId" class="form-label">Secondary Insurance ID</label>
                <input type="text" class="form-control" id="secondaryId" name="secondaryId">
              </div>
              <div class="col-md-3">
                <label for="secondaryGroup" class="form-label">Group #</label>
                <input type="text" class="form-control" id="secondaryGroup" name="secondaryGroup">
              </div>
              <div class="col-md-6">
                <label for="secondaryPayerId" class="form-label">Secondary Insurance Payer ID</label>
                <input type="text" class="form-control" id="secondaryPayerId" name="secondaryPayerId">
              </div>
            </div>
          </div>
  
          <!-- Consent & Signature -->
          <div class="mb-4">
            <h4>Consent &amp; Signature</h4>
            <div class="mb-3">
              <label for="consent1" class="form-label">Privacy Notice</label>
              <iframe
                src="https://docs.google.com/gview?url=https://prism.org/PublicFiles/PrivacyNotice.pdf&embedded=true"
                style="width:100%; height:500px; border:1px solid #ccc;"
                frameborder="0"
              ></iframe>
              <p>If your browser has trouble loading the above PDF, please try refreshing the page or click <a href="https://prism.org/PublicFiles/PrivacyNotice.pdf" target="_blank">here</a> to view the privacy notice in a new tab.</p>
            </div>
            <div class="mb-3">
              <label for="consent2" class="form-label">Vaccination Consent</label>
              <iframe
                src="https://docs.google.com/gview?url=https://prism.org/PublicFiles/VaccinationConsent.pdf&embedded=true"
                style="width:100%; height:500px; border:1px solid #ccc;"
                frameborder="0"
              ></iframe>
              <p>If your browser has trouble loading the above PDF, please try refreshing the page or click <a href="https://prism.org/PublicFiles/VaccinationConsent.pdf" target="_blank">here</a> to view the vaccination consent form in a new tab.</p>
            </div>
            <p>Please sign below, acknowledging you have read and agree to the above policies:</p>
            <canvas id="sigPad" class="border"></canvas><br>
            <button class="btn btn-outline-secondary mt-2" type="button" onclick="pad.clear()">Clear Signature</button>
          </div>
  
          <button class="btn btn-primary" type="submit">Submit Registration</button>
        </form>
    </div>

    <div id="confirmationSection" class="container d-none mt-5">
        <h2>Registration Confirmed</h2>
        <p><strong>Event:</strong> <span id="confEventName"></span></p>
        <p><strong>Date:</strong> <span id="confEventDate"></span></p>
        <p><strong>Patient:</strong> <span id="confPatientName"></span></p>
        <p><strong>Date of Birth:</strong> <span id="confPatientDob"></span></p>
        <p><strong>Appointment ID:</strong> <span id="confApptId"></span></p>
        <div class="mt-3">
            <img id="confQrCode" alt="QR code for Appointment ID" />
        </div>
        <p><i>A confirmation has been emailed to you. Please feel free to take a screenshot.</i></p>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/signature_pad@4.1.7/dist/signature_pad.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>

    <script src="script.js"></script>
</body>
</html>
